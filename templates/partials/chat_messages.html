{% for msg in messages %}
<div class="flex flex-col mb-3 {{ 'items-end' if msg.user_id == current_user.id else 'items-start' }}">
    {% if msg.user_id != current_user.id %}
    <span class="text-[10px] font-bold text-gray-500 dark:text-gray-400 ml-1 mb-1 lowercase">
        @{{ msg.user.username }}
    </span>
    {% endif %}
    
    <div class="max-w-[85%] px-6 py-3 rounded-2xl text-base shadow-sm transition-colors {{ 'text-white rounded-tr-none' if msg.user_id == current_user.id else 'bg-gray-200 dark:bg-gray-700 dark:text-gray-100 text-gray-800 rounded-tl-none border border-transparent dark:border-gray-600' }}"
         style="{{ 'background-color: var(--color-' + current_user.accent_color + '-600);' if msg.user_id == current_user.id else '' }}">
        {{ msg.message }}
    </div>
    
    <div class="flex items-center gap-1 mt-1 px-1">
        <span class="text-[9px] text-gray-400 uppercase tracking-tighter">{{ msg.timestamp.strftime('%H:%M') }}</span>
    </div>
</div>
{% endfor %}