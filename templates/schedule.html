{% extends 'base.html' %}

{% block content %}
<div class="max-w-6xl mx-auto space-y-12" x-data="{ showForm: false }">
    <!-- Header Section -->
    <div class="flex items-baseline justify-between noir-header pb-4">
        <h1 class="text-4xl font-bold tracking-tighter mono-display uppercase">Timeline_Map</h1>
        <div class="flex items-center gap-6">
            <span class="text-xs font-bold opacity-50 uppercase tracking-widest">Protocol: Temporal_Scheduling</span>
            <button @click="showForm = !showForm" class="noir-button text-xs px-6 py-2">
                <span x-text="showForm ? 'ABORT_ENTRY' : 'NEW_EVENT_SIGNAL'"></span>
            </button>
        </div>
    </div>

    <!-- Add Event Block -->
    <div x-show="showForm" x-transition class="noir-border bg-[var(--bg-alt)]" style="display: none;">
        <h2 class="text-lg font-bold mono-display uppercase tracking-widest border-b noir-border pb-2 mb-8">Define_Temporal_Point</h2>
        <form action="{{ url_for('schedule.add_event') }}" method="POST" class="space-y-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="md:col-span-2">
                    <label class="block text-[10px] font-bold opacity-50 uppercase tracking-widest mb-2">Subject_Label</label>
                    <input type="text" name="title" required placeholder="EVENT_IDENTIFIER" class="noir-input w-full font-bold">
                </div>
                
                <div class="space-y-2">
                    <label class="block text-[10px] font-bold opacity-50 uppercase tracking-widest">Entry_Point (START)</label>
                    <input type="datetime-local" name="start_time" required class="noir-input w-full text-xs">
                </div>
                
                <div class="space-y-2">
                    <label class="block text-[10px] font-bold opacity-50 uppercase tracking-widest">Exit_Point (END)</label>
                    <input type="datetime-local" name="end_time" required class="noir-input w-full text-xs">
                </div>
                
                <div class="md:col-span-2" x-data="{ recurrence: 'none' }">
                    <label class="block text-[10px] font-bold opacity-50 uppercase tracking-widest mb-2">Cycle_Recurrence</label>
                    <select name="recurrence" x-model="recurrence" class="noir-input w-full text-xs bg-transparent font-bold">
                        <option value="none">SINGULAR_OCCURRENCE</option>
                        <option value="daily">CYCLE_24H (DAILY)</option>
                        <option value="weekly">CYCLE_07D (WEEKLY)</option>
                        <option value="monthly">CYCLE_30D (MONTHLY)</option>
                        <option value="custom">USER_DEFINED_RECURRENCE</option>
                    </select>

                    <div x-show="recurrence === 'custom'" class="mt-6 noir-border bg-accent/5 border-dashed space-y-4">
                        <label class="block text-[9px] font-bold opacity-50 uppercase">Active_Nodes (DAYS):</label>
                        <div class="flex flex-wrap gap-4">
                            {% set days = ['MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT', 'SUN'] %}
                            {% for i in range(7) %}
                            <label class="inline-flex items-center group cursor-pointer">
                                <input type="checkbox" name="recurrence_days" value="{{ i }}" class="w-4 h-4 accent-accent">
                                <span class="ml-2 text-[10px] font-bold group-hover:text-accent transition-colors">{{ days[i] }}</span>
                            </label>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="pt-4 flex justify-end">
                <button type="submit" class="noir-button px-12 py-3">COMMIT_EVENT</button>
            </div>
        </form>
    </div>

    <!-- Events Array -->
    <div class="space-y-6">
        <div class="flex items-center gap-4">
            <h2 class="text-xl font-bold mono-display uppercase tracking-widest">Scheduled_Data_Points</h2>
            <div class="flex-1 h-[1px] bg-black dark:bg-white opacity-10"></div>
        </div>
        
        <div class="noir-border bg-[var(--bg-alt)] divide-y divide-black dark:divide-white divide-opacity-10">
            {% for event in events %}
                {% include 'partials/event_item.html' %}
            {% else %}
                <div class="p-20 text-center opacity-30">
                    <span class="text-xs font-bold uppercase tracking-widest">TEMPORAL_QUEUE_EMPTY // NO_POINTS_DEFINED</span>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
